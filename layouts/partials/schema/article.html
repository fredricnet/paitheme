{{- /*
    Article Schema (JSON-LD)
    
    Outputs Article/BlogPosting structured data for blog posts.
    Uses frontmatter for author, date, image, tags.
    
    Reference: https://schema.org/Article
*/ -}}

{{- $siteConfig := site.Data.site -}}
{{- $schema := $siteConfig.schema -}}
{{- $org := $schema.organization -}}
{{- $defaultAuthor := $schema.default_author -}}

{{- /* Get author from frontmatter or default */ -}}
{{- $authorName := .Params.author | default ($defaultAuthor.name | default "Editorial Team") -}}
{{- $authorUrl := .Params.author_url | default ($defaultAuthor.url | default "") -}}

<script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Article",
    "headline": {{ .Title | jsonify }},
    {{- if .Description }}
    "description": {{ .Description | jsonify }},
    {{- end }}
    "url": {{ .Permalink | jsonify }},
    {{- if .Params.image }}
    "image": {
        "@type": "ImageObject",
        "url": {{ .Params.image | absURL | jsonify }}
    },
    {{- end }}
    {{- if not .PublishDate.IsZero }}
    "datePublished": {{ .PublishDate.Format "2006-01-02T15:04:05Z07:00" | jsonify }},
    {{- else if not .Date.IsZero }}
    "datePublished": {{ .Date.Format "2006-01-02T15:04:05Z07:00" | jsonify }},
    {{- end }}
    {{- if not .Lastmod.IsZero }}
    "dateModified": {{ .Lastmod.Format "2006-01-02T15:04:05Z07:00" | jsonify }},
    {{- end }}
    "author": {
        "@type": "Person",
        "name": {{ $authorName | jsonify }}
        {{- if $authorUrl }},
        "url": {{ $authorUrl | jsonify }}
        {{- end }}
    },
    {{- if $org }}
    "publisher": {
        "@type": "Organization",
        "name": {{ $org.name | default site.Title | jsonify }},
        {{- if $org.logo }}
        "logo": {
            "@type": "ImageObject",
            "url": {{ $org.logo | jsonify }}
        }
        {{- end }}
    },
    {{- end }}
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": {{ .Permalink | jsonify }}
    },
    "inLanguage": {{ site.Language.Lang | default "en" | jsonify }}
    {{- if .Params.tags }},
    "keywords": {{ delimit .Params.tags ", " | jsonify }}
    {{- end }}
}
</script>

