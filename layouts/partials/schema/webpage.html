{{- /*
    WebPage Schema (JSON-LD)
    
    Outputs WebPage structured data for all pages.
    Automatically adapts based on page type.
    
    Reference: https://schema.org/WebPage
*/ -}}

{{- $siteConfig := site.Data.site -}}
{{- $schema := $siteConfig.schema -}}
{{- $org := $schema.organization -}}

{{- /* Determine page type */ -}}
{{- $pageType := "WebPage" -}}
{{- if .IsHome -}}
    {{- $pageType = "WebPage" -}}
{{- else if eq .Section "blog" -}}
    {{- $pageType = "BlogPosting" -}}
{{- else if eq .Section "docs" -}}
    {{- $pageType = "TechArticle" -}}
{{- else if eq .Section "dictionary" -}}
    {{- $pageType = "DefinedTermSet" -}}
{{- else if .IsSection -}}
    {{- $pageType = "CollectionPage" -}}
{{- end -}}

<script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": {{ $pageType | jsonify }},
    "name": {{ .Title | jsonify }},
    "headline": {{ .Title | jsonify }},
    {{- if .Description }}
    "description": {{ .Description | jsonify }},
    {{- else if site.Params.description }}
    "description": {{ site.Params.description | jsonify }},
    {{- end }}
    "url": {{ .Permalink | jsonify }},
    {{- if .Params.image }}
    "image": {{ .Params.image | absURL | jsonify }},
    {{- end }}
    {{- if not .PublishDate.IsZero }}
    "datePublished": {{ .PublishDate.Format "2006-01-02T15:04:05Z07:00" | jsonify }},
    {{- else if not .Date.IsZero }}
    "datePublished": {{ .Date.Format "2006-01-02T15:04:05Z07:00" | jsonify }},
    {{- end }}
    {{- if not .Lastmod.IsZero }}
    "dateModified": {{ .Lastmod.Format "2006-01-02T15:04:05Z07:00" | jsonify }},
    {{- end }}
    "inLanguage": {{ site.Language.Lang | default "en" | jsonify }},
    "isPartOf": {
        "@type": "WebSite",
        "name": {{ site.Title | jsonify }},
        "url": {{ site.BaseURL | jsonify }}
    },
    {{- if $org }}
    "publisher": {
        "@type": "Organization",
        "name": {{ $org.name | default site.Title | jsonify }},
        {{- if $org.logo }}
        "logo": {
            "@type": "ImageObject",
            "url": {{ $org.logo | jsonify }}
        }
        {{- end }}
    }
    {{- else }}
    "publisher": {
        "@type": "Organization",
        "name": {{ site.Title | jsonify }}
    }
    {{- end }}
}
</script>

